import PhotoSwipe from"photoswipe";import PhotoSwipeUIDefault from"photoswipe/src/js/ui/photoswipe-ui-default";import TweenMax from"gsap/TweenMax";import initPageTransitions from"./initPageTransitions";import Util from"./utils/util";class Demo1{constructor(){initPageTransitions(),this.initDemo(),this.initPhotoSwipeFromDOM(".my-gallery"),this.scaleGrid(),window.addEventListener("resize",Util.debounce(()=>{this.scaleGrid()},10))}initDemo(){const{Back:a}=window;this.easing=a.easeInOut.config(1.7),this.gridInner=document.querySelector(".grid__inner"),this.cursorWrapper=document.querySelector(".cursor-wrapper"),this.innerCursor=document.querySelector(".custom-cursor__inner"),this.outerCursor=document.querySelector(".custom-cursor__outer"),this.cursorWrapperBox=this.cursorWrapper.getBoundingClientRect(),this.innerCursorBox=this.innerCursor.getBoundingClientRect(),this.outerCursorBox=this.outerCursor.getBoundingClientRect(),document.addEventListener("mousemove",a=>{this.clientX=a.clientX,this.clientY=a.clientY});const b=()=>{TweenMax.set(this.cursorWrapper,{x:this.clientX,y:this.clientY}),requestAnimationFrame(b)};requestAnimationFrame(b),this.fullCursorSize=40,this.enlargeCursorTween=TweenMax.to(this.outerCursor,.3,{backgroundColor:"transparent",width:this.fullCursorSize,height:this.fullCursorSize,ease:this.easing,paused:!0}),this.mainNavHoverTween=TweenMax.to(this.outerCursor,.3,{backgroundColor:"#ffffff",opacity:.3,width:this.fullCursorSize,height:this.fullCursorSize,ease:this.easing,paused:!0});const c=()=>{this.enlargeCursorTween.play()},d=()=>{this.enlargeCursorTween.reverse()},e=document.querySelectorAll(".grid__item");e.forEach(a=>{a.addEventListener("mouseenter",c),a.addEventListener("mouseleave",d)});const f=document.querySelector(".pswp__container");f.addEventListener("mouseenter",c);const g=document.querySelectorAll(".content--fixed a");g.forEach(a=>{a.addEventListener("mouseenter",()=>{this.mainNavHoverTween.play()}),a.addEventListener("mouseleave",()=>{this.mainNavHoverTween.reverse()})}),this.bumpCursorTween=TweenMax.to(this.outerCursor,.1,{scale:.7,paused:!0,onComplete:()=>{TweenMax.to(this.outerCursor,.2,{scale:1,ease:this.easing})}})}openGalleryActions(){this.bumpCursorTween.play(),this.innerCursor.classList.add("is-closing"),this.cursorWrapper.classList.add("has-blend-mode"),this.cursorWrapper.classList.remove("is-outside")}closeGalleryactions(){this.bumpCursorTween.play(),this.innerCursor.classList.remove("is-closing"),this.cursorWrapper.classList.remove("has-blend-mode"),setTimeout(()=>{const a=document.elementFromPoint(this.clientX,this.clientY);a.classList.contains("grid__thumbnail")||this.enlargeCursorTween.reverse()},400)}initPhotoSwipeFromDOM(a){const b=a=>{const b=a.childNodes,c=b.length,d=[];let e,f,g,h;for(let j=0;j<c;j++)(e=b[j],1===e.nodeType)&&(f=e.children[0],g=f.getAttribute("data-size").split("x"),h={src:f.getAttribute("href"),w:parseInt(g[0],10),h:parseInt(g[1],10)},1<e.children.length&&(h.title=e.children[1].innerHTML),0<f.children.length&&(h.msrc=f.children[0].getAttribute("src")),h.el=e,d.push(h));return d},c=function a(b,c){return b&&(c(b)?b:a(b.parentNode,c))},d=a=>{a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1;const b=a.target||a.srcElement,d=c(b,function(a){return a.tagName&&"FIGURE"===a.tagName.toUpperCase()});if(d){for(var f,g=d.parentNode,h=d.parentNode.childNodes,j=h.length,k=0,l=0;l<j;l++)if(1===h[l].nodeType){if(h[l]===d){f=k;break}k++}return 0<=f&&e(f,g),!1}},e=(a,c,d,e)=>{const f=document.querySelectorAll(".pswp")[0],g=b(c),h={galleryUID:c.getAttribute("data-pswp-uid"),getThumbBoundsFn:()=>{const b=g[a].el.getElementsByTagName("img")[0],c=window.pageYOffset||document.documentElement.scrollTop,d=b.getBoundingClientRect();return{x:d.left,y:d.top+c,w:d.width}},captionEl:!1,closeEl:!1,arrowEl:!1,fullscreenEl:!1,shareEl:!1,counterEl:!1,zoomEl:!1,maxSpreadZoom:1,barsSize:{top:80,bottom:80,left:40,right:40},closeElClasses:["item","caption","zoom-wrap","ui","top-bar","img"],getDoubleTapZoom:(a,b)=>b.initialZoomLevel,pinchToClose:!1};if(!e)h.index=parseInt(a,10);else if(h.galleryPIDs){for(let b=0;b<g.length;b++)if(g[b].pid===a){h.index=b;break}}else h.index=parseInt(a,10)-1;if(isNaN(h.index))return;d&&(h.showAnimationDuration=0);const i=new PhotoSwipe(f,PhotoSwipeUIDefault,g,h);i.init(),this.openGalleryActions(),i.listen("initialZoomOut",()=>{}),i.listen("close",()=>{this.closeGalleryactions()});const j=()=>{const a=i.currItem.container,b=Array.from(a.querySelectorAll(".pswp__img")).pop();b.addEventListener("mouseenter",()=>{this.cursorWrapper.classList.remove("is-outside")},!1);b.addEventListener("mouseleave",()=>{this.cursorWrapper.classList.add("is-outside")},!1)};i.listen("initialZoomInEnd",()=>{j()}),i.listen("afterChange",()=>{j()})},f=document.querySelectorAll(a);f.forEach((a,b)=>{a.setAttribute("data-pswp-uid",b+1),a.onclick=d});const g=(()=>{const a=window.location.hash.substring(1),b={};if(5>a.length)return b;const c=a.split("&");for(let a=0;a<c.length;a++){if(!c[a])continue;const d=c[a].split("=");2>d.length||(b[d[0]]=d[1])}return b.gid&&(b.gid=parseInt(b.gid,10)),b})();g.pid&&g.gid&&e(g.pid,f[g.gid-1],!0,!0)}scaleGrid(){this.gridInner.style.transform=`scale(1)`;const a=this.gridInner.getBoundingClientRect(),b=window.innerWidth-70,c=window.innerHeight-230,d=Math.min(b/a.width,c/a.height);this.gridInner.style.transform=`scale(${d})`}}export default Demo1;